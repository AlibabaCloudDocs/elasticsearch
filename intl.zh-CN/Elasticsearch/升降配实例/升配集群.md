---
keyword: es集群升配
---

# 升配集群

随着业务的发展，您可能对集群配置的要求越来越高。当集群的配置无法满足业务需求时，可通过集群升配功能，升级集群配置。本文介绍阿里云Elasticsearch集群升级配置的相关说明、注意事项和操作方法。

-   完成集群规格容量评估。

    评估方法，请参见[规格容量评估]()。

-   确保升配前后，阿里云Elasticsearch实例规格满足ECS侧支持的规格。

    详细信息，请参见[支持变配的实例规格](/intl.zh-CN/实例/升降配实例/修改实例规格/支持变配的实例规格.md)。

-   [登录Kibana控制台](/intl.zh-CN/Elasticsearch/可视化控制/Kibana/登录Kibana控制台.md)，执行以下命令，检查集群中是否存在状态为close的索引。如果存在，需要open或delete对应索引，否则变更不成功。
    -   查看索引状态

        ```
        GET /_cat/indices?v
        ```

        ![查看索引状态](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7521954161/p244657.png)

    -   open状态为close的索引

        ```
        POST /<index_name>/_open
        ```

    -   delete状态为close的索引

        **警告：** 索引删除后不可恢复，请谨慎操作。

        ```
        DELETE /<index_name>
        ```


## 注意事项

-   规格升配

    每次只能变更一种节点类型（数据节点、冷数据节点、协调节点、专有主节点、Kibana节点、弹性节点）的配置。

    **说明：** 如果您需要减少数据节点个数，可通过缩容数据节点功能实现。具体操作方法和限制，请参见[缩容集群数据节点](/intl.zh-CN/Elasticsearch/升降配实例/缩容集群数据节点.md)。

-   服务影响
    -   升配集群会触发集群重启，重启时间与集群规格、数据结构和大小等因素有关。一般情况下，重启耗时较长，在小时级别。详细信息，请参见[重启实例或节点](/intl.zh-CN/Elasticsearch/管理实例/重启实例或节点.md)。

        **说明：**

        -   如果集群索引存在副本分片且集群负载处于正常水平（CPU使用率在60%左右，堆内存使用率在50%左右，load\_1m低于CPU核数），一般情况下，在集群变更过程中可持续对外提供服务。
        -   如果集群负载过高且索引没有副本，同时在升配或者降配过程中存在大量的写入或查询等情况，业务可能会出现偶发的访问超时现象。建议在集群变更前，在客户端访问机制中配置重试机制，以减小对业务的影响。
    -   如果实例为非正常状态（黄色或红色），在升配集群时，需要勾选**强制变更，忽略集群健康状态**，此操作可能会影响服务。
-   版本升级

    不支持在升配集群时升级，需要通过版本升级功能升级。详细信息，请参见[升级版本](/intl.zh-CN/Elasticsearch/版本升级/升级版本.md)。

    **说明：** 如果在升配集群时，版本变更不符合要求，系统会提示UpgradeVersionMustFromConsole。

-   计费变化

    当您提交了升配订单后，实例将按照更新后的订单计费。

    **说明：** 在升配集群时，您可以在**变配**页面，实时观察更新后的订单消费金额。


## 操作步骤

1.  登录[阿里云Elasticsearch控制台](https://elasticsearch.console.aliyun.com/#/home)。

2.  在左侧导航栏，单击**Elasticsearch实例**。

3.  在顶部菜单栏处，选择资源组和地域，然后在**Elasticsearch实例**中单击目标实例ID。

4.  在**基本信息**页面，单击**配置变更** \> **集群升配**。

5.  修改节点规格、存储类型、单节点存储空间等配置。

    变配页面的**当前配置**区域，展示了当前实例的配置信息，便于您在执行升配操作时参考。

    请根据实际业务需求，通过页面提示修改实例配置。参数详情，请参见[购买页面参数](/intl.zh-CN/Elasticsearch/快速入门/步骤一：创建实例/购买页面参数.md)，部分参数说明如下。

    **说明：** 在升配集群时，如果遇到可用区规格库存不足的问题，可迁移该可用区下的节点后再升配。具体操作，请参见[迁移可用区节点](/intl.zh-CN/Elasticsearch/数据迁移/迁移可用区节点.md)。

    |参数|说明|
    |--|--|
    |**数据节点**|当**规格族**为**云盘型**时，您可以增大**数据节点**的**单节点存储空间**。云盘的**存储类型**不同，支持的最大存储空间也不同，具体限制可在控制台上查看。|
    |**专有主节点**|支持新购专有主节点，或者升配已购买的专有主节点的规格。**说明：** 如果您已经购买了1核2G规格的专有主节点，可在**变配**页面，重新购买更高规格的专有主节点，系统将按照新规格的定价重新计费。如果之前的专有主节点是系统为您赠送的，变更后该专有主节点将变为计费模式。 |
    |**冷数据节点**|支持新购冷数据节点，或者升配已购买的冷数据节点的规格。|
    |**协调节点**|支持新购协调节点，或者升配已购买的协调节点的规格。|
    |**Kibana节点**|支持升配已购买的Kibana节点的规格。**说明：** 当您购买了阿里云Elasticsearch实例后，系统默认会为您赠送一个1核2G的Kibana节点。您可以通过集群升配操作变更Kibana节点规格。 |
    |**强制变更**|如果实例为非正常状态（红色或黄色），且服务已受到严重影响，急需通过扩容来解决，建议使用**强制变更**（忽略实例的健康状态，耗时较短）。**说明：**

    -   **强制变更**会重启实例，可能会导致服务在重启阶段不稳定。
    -   未启用**强制变更**时，系统默认使用**重启**方式升配集群。相关注意事项，请参见[重启实例或节点](/intl.zh-CN/Elasticsearch/管理实例/重启实例或节点.md)。 |

6.  选中服务协议，单击**立即购买**。

    购买后，集群会重启，重启成功后即可完成集群升配。


